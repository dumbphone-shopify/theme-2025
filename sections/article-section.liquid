{{ 'video-section.css' | asset_url | stylesheet_tag }}
{{ 'component-deferred-media.css' | asset_url | stylesheet_tag }}

{% assign hero_type = article.metafields.custom.hero_type.value | default: 'image' %}
{% assign hero_video_url = article.metafields.custom.hero_video_url %}
{% assign hero_video_thumb = article.metafields.custom.hero_video_thumb %}
{% assign show_author = true %}

<div class="article-wrapper">
  {% if hero_type == 'image' and article.image %}
    <div class="article-hero">
      <img src="{{ article.image | image_url: width: 2000 }}" alt="{{ article.image.alt | escape }}">
    </div>

  {% elsif hero_type == 'video' and hero_video_url %}
    <div class="article-hero article-hero__video">
      <deferred-media class="deferred-media video-section__media gradient global-media-settings" data-media-id="video">
        <button
          class="video-section__poster media deferred-media__poster media--landscape"
          type="button"
          aria-label="{{ article.title }}">
          {% if hero_video_thumb %}
            {{ hero_video_thumb | image_url: width: 2000 | image_tag: alt: article.title }}
          {% endif %}
          <span class="deferred-media__poster-button motion-reduce">
            <span class="svg-wrapper">
              {{ 'icon-play.svg' | inline_asset_content }}
            </span>
          </span>
        </button>
        <template>
          <iframe
            src="{{ hero_video_url }}?autoplay=1"
            allow="autoplay; encrypted-media"
            allowfullscreen
            title="{{ article.title }}"></iframe>
        </template>
      </deferred-media>
    </div>
  {% endif %}

  <div class="article-content">
    <h1 class="article-title">{{ article.title }}</h1>

    {% if show_author %}
      <p class="article-author">Af {{ article.author }}</p>
    {% endif %}

    <div class="text-content">
      {{ article.content }}
    </div>
  </div>
</div>

{% stylesheet %}
  :root  {
    --col-50: clamp(0rem, -1.1364rem + 5.6818vw, 3.125rem);
    --col-100: clamp(0rem, -2.2727rem + 11.3636vw, 6.25rem);
    --img-article-pad: clamp(2rem, 1.8261rem + 0.8696vw, 2.5rem);
    --inner-article: clamp(20rem, 15.4545rem + 22.7273vw, 32.5rem);
  }

  .article-wrapper {
    display: grid;
    grid-template-columns: [full-start] var(--col-100) [breakout-start] var(--col-100) [content-start] var(--col-50) [inner] 7fr var(--col-50) [content-end] var(--col-100) [breakout-end] var(--col-100) [full-end];
  }

  .article-hero {
    grid-column: full;
    display: grid;
    grid-template-columns: subgrid;
  }

  .article-hero img,
  .article-hero iframe,
  .article-hero video,
  .article-hero .deferred-media {
    grid-column: full;
    width: 100%;
    height: auto;
    display: block;
    margin-inline: auto;
    max-width: 1000px;
  }

  .deferred-media {
    aspect-ratio: 16 / 9;
    width: 100%;
    max-width: 1000px;
    min-width: 250px;
    min-height: 140px;
    margin-inline: auto;
    background: #000;
    display: block;
    position: relative;
    overflow: hidden;
    height: 0;
  }

  @supports (aspect-ratio: 16 / 9) {
    .deferred-media {
      height: auto;
      padding-bottom: 0;
    }
  }

  .deferred-media > * {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .article-title {
    margin: 2rem 0 1rem;
    font-size: 3.25rem;
    line-height: 1.2;
  }

  .article-content {
    grid-column: full;
    display: grid;
    grid-template-columns: [full-start] var(--col-100) [breakout-start] var(--col-100) [content-start] var(--col-50) [inner] 4fr var(--col-50) [content-end] var(--col-100) [breakout-end] var(--col-100) [full-end];
  }

  .article-content p,
  .text-content,
  .article-title {
    grid-column: inner;
    max-width: 550px;
    margin-inline: auto;
    width: 100%;
  }

  .article-author {
    grid-column: inner;
    margin-bottom: 1rem;
    font-style: italic;
    color: #666;
    text-align: center;
  }

  .article-image {
    border-radius: 25px;
    display: block;
    width: 100%;
    margin: var(--img-article-pad) auto;
  }

  iframe,
  .deferred-media__poster,
  .article-hero img {
    border-radius: 25px !important;
  }

  @media screen and (max-width: 1000px) {
    .article-image--medium,
    .article-image--large,
    iframe,
    .deferred-media__poster,
    .article-hero img {
      border-radius: 0 !important;
    }
  }
{% endstylesheet %}